gef➤  x/10wx $ebp
0xffffce68:     0xffffce78      0x080491da      0xffffce90      0x00000000
0xffffce78:     0x00000000      0xf7dc5efe      0xf7f8ee24      0xf7f8ee24
0xffffce88:     0x00000000      0xf7dc5efe
gef➤  set *0xffffce68=0x8049060
gef➤  set *0xffffce6c=0x8049060
gef➤  set *0xffffce70=0x8049186
gef➤  set *0xffffce74=0x1
gef➤  set *0xffffce78=0x804c014
gef➤  set *0xffffce7c=0x4
gef➤  x/10wx $ebp
0xffffce68:     0x08049060      0x08049060      0x08049186      0x00000001
0xffffce78:     0x0804c014      0x00000004      0xf7f8ee24      0xf7f8ee24
0xffffce88:     0x00000000      0xf7dc5efe


0xf7e9aed0

gef➤  p vulnerable_function 
$1 = {void ()} 0x8049186 <vulnerable_function>

gef➤  p vulnerable_function 
$1 = {void ()} 0x8049186 <vulnerable_function>
[ Legend:  Code | Heap | Stack ]
Start      End        Offset     Perm Path
0x08048000 0x0804b000 0x00000000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804b000 0x0804c000 0x00002000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804c000 0x0804d000 0x00003000 rwx /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0xf7da7000 0xf7f8d000 0x00000000 r-x /usr/lib32/libc-2.31.so
0xf7f8d000 0xf7f8f000 0x001e5000 r-x /usr/lib32/libc-2.31.so
0xf7f8f000 0xf7f91000 0x001e7000 rwx /usr/lib32/libc-2.31.so
0xf7f91000 0xf7f95000 0x00000000 rwx 
0xf7fcd000 0xf7fd0000 0x00000000 r-- [vvar]
0xf7fd0000 0xf7fd2000 0x00000000 r-x [vdso]
0xf7fd2000 0xf7ffc000 0x00000000 r-x /usr/lib32/ld-2.31.so
0xf7ffc000 0xf7ffd000 0x00029000 r-x /usr/lib32/ld-2.31.so
0xf7ffd000 0xf7ffe000 0x0002a000 rwx /usr/lib32/ld-2.31.so


gef➤  p vulnerable_function 
$2 = {void ()} 0x8049186 <vulnerable_function>
[ Legend:  Code | Heap | Stack ]
Start      End        Offset     Perm Path
0x08048000 0x0804b000 0x00000000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804b000 0x0804c000 0x00002000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804c000 0x0804d000 0x00003000 rwx /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0xf7da7000 0xf7f8d000 0x00000000 r-x /usr/lib32/libc-2.31.so
0xf7f8d000 0xf7f8f000 0x001e5000 r-x /usr/lib32/libc-2.31.so
0xf7f8f000 0xf7f91000 0x001e7000 rwx /usr/lib32/libc-2.31.so
0xf7f91000 0xf7f95000 0x00000000 rwx 
0xf7fcd000 0xf7fd0000 0x00000000 r-- [vvar]
0xf7fd0000 0xf7fd2000 0x00000000 r-x [vdso]
0xf7fd2000 0xf7ffc000 0x00000000 r-x /usr/lib32/ld-2.31.so
0xf7ffc000 0xf7ffd000 0x00029000 r-x /usr/lib32/ld-2.31.so
0xf7ffd000 0xf7ffe000 0x0002a000 rwx /usr/lib32/ld-2.31.so
0xfffdd000 0xffffe000 0x00000000 rwx [stack]

0x08048000 0x0804b000 0x00000000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804b000 0x0804c000 0x00002000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0x0804c000 0x0804d000 0x00003000 rwx /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level2
0xf7da7000 0xf7f8d000 0x00000000 r-x /usr/lib32/libc-2.31.so
0xf7f8d000 0xf7f8f000 0x001e5000 r-x /usr/lib32/libc-2.31.so
0xf7f8f000 0xf7f91000 0x001e7000 rwx /usr/lib32/libc-2.31.so
0xf7f91000 0xf7f95000 0x00000000 rwx 
0xf7fcd000 0xf7fd0000 0x00000000 r-- [vvar]
0xf7fd0000 0xf7fd2000 0x00000000 r-x [vdso]
0xf7fd2000 0xf7ffc000 0x00000000 r-x /usr/lib32/ld-2.31.so
0xf7ffc000 0xf7ffd000 0x00029000 r-x /usr/lib32/ld-2.31.so
0xf7ffd000 0xf7ffe000 0x0002a000 rwx /usr/lib32/ld-2.31.so
0xfffdd000 0xffffe000 0x00000000 rwx [stack]
gef➤  p vulnerable_function 
$1 = {void ()} 0x8049186 <vulnerable_function>






gef➤  p vulnerable_function 
$1 = {void ()} 0x555555555159 <vulnerable_function>
gef➤  vmmap 
[ Legend:  Code | Heap | Stack ]
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555555000 0x0000000000000000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555555000 0x0000555555556000 0x0000000000001000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555556000 0x0000555555557000 0x0000000000002000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555557000 0x0000555555558000 0x0000000000002000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555558000 0x0000555555559000 0x0000000000003000 rw- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x00007ffff7dcb000 0x00007ffff7df0000 0x0000000000000000 r-- /usr/lib/libc-2.31.so
0x00007ffff7df0000 0x00007ffff7f3d000 0x0000000000025000 r-x /usr/lib/libc-2.31.so
0x00007ffff7f3d000 0x00007ffff7f87000 0x0000000000172000 r-- /usr/lib/libc-2.31.so
0x00007ffff7f87000 0x00007ffff7f88000 0x00000000001bc000 --- /usr/lib/libc-2.31.so
0x00007ffff7f88000 0x00007ffff7f8b000 0x00000000001bc000 r-- /usr/lib/libc-2.31.so
0x00007ffff7f8b000 0x00007ffff7f8e000 0x00000000001bf000 rw- /usr/lib/libc-2.31.so
0x00007ffff7f8e000 0x00007ffff7f94000 0x0000000000000000 rw- 
0x00007ffff7fcc000 0x00007ffff7fcf000 0x0000000000000000 r-- [vvar]
0x00007ffff7fcf000 0x00007ffff7fd1000 0x0000000000000000 r-x [vdso]
0x00007ffff7fd1000 0x00007ffff7fd3000 0x0000000000000000 r-- /usr/lib/ld-2.31.so
0x00007ffff7fd3000 0x00007ffff7ff3000 0x0000000000002000 r-x /usr/lib/ld-2.31.so
0x00007ffff7ff3000 0x00007ffff7ffb000 0x0000000000022000 r-- /usr/lib/ld-2.31.so
0x00007ffff7ffc000 0x00007ffff7ffd000 0x000000000002a000 r-- /usr/lib/ld-2.31.so
0x00007ffff7ffd000 0x00007ffff7ffe000 0x000000000002b000 rw- /usr/lib/ld-2.31.so
0x00007ffff7ffe000 0x00007ffff7fff000 0x0000000000000000 rw- 
0x00007ffffffde000 0x00007ffffffff000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]

gef➤  p vulnerable_function 
$2 = {void ()} 0x555555555159 <vulnerable_function>
gef➤  vmmap 
[ Legend:  Code | Heap | Stack ]
Start              End                Offset             Perm Path
0x0000555555554000 0x0000555555555000 0x0000000000000000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555555000 0x0000555555556000 0x0000000000001000 r-x /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555556000 0x0000555555557000 0x0000000000002000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555557000 0x0000555555558000 0x0000000000002000 r-- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x0000555555558000 0x0000555555559000 0x0000000000003000 rw- /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
0x00007ffff7dcb000 0x00007ffff7df0000 0x0000000000000000 r-- /usr/lib/libc-2.31.so
0x00007ffff7df0000 0x00007ffff7f3d000 0x0000000000025000 r-x /usr/lib/libc-2.31.so
0x00007ffff7f3d000 0x00007ffff7f87000 0x0000000000172000 r-- /usr/lib/libc-2.31.so
0x00007ffff7f87000 0x00007ffff7f88000 0x00000000001bc000 --- /usr/lib/libc-2.31.so
0x00007ffff7f88000 0x00007ffff7f8b000 0x00000000001bc000 r-- /usr/lib/libc-2.31.so
0x00007ffff7f8b000 0x00007ffff7f8e000 0x00000000001bf000 rw- /usr/lib/libc-2.31.so
0x00007ffff7f8e000 0x00007ffff7f94000 0x0000000000000000 rw- 
0x00007ffff7fcc000 0x00007ffff7fcf000 0x0000000000000000 r-- [vvar]
0x00007ffff7fcf000 0x00007ffff7fd1000 0x0000000000000000 r-x [vdso]
0x00007ffff7fd1000 0x00007ffff7fd3000 0x0000000000000000 r-- /usr/lib/ld-2.31.so
0x00007ffff7fd3000 0x00007ffff7ff3000 0x0000000000002000 r-x /usr/lib/ld-2.31.so
0x00007ffff7ff3000 0x00007ffff7ffb000 0x0000000000022000 r-- /usr/lib/ld-2.31.so
0x00007ffff7ffc000 0x00007ffff7ffd000 0x000000000002a000 r-- /usr/lib/ld-2.31.so
0x00007ffff7ffd000 0x00007ffff7ffe000 0x000000000002b000 rw- /usr/lib/ld-2.31.so
0x00007ffff7ffe000 0x00007ffff7fff000 0x0000000000000000 rw- 
0x00007ffffffde000 0x00007ffffffff000 0x0000000000000000 rw- [stack]
0xffffffffff600000 0xffffffffff601000 0x0000000000000000 r-x [vsyscall]

55a8a002e000-55a8a002f000 r--p 00000000 08:02 40374936                   /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
55a8a002f000-55a8a0030000 r-xp 00001000 08:02 40374936                   /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
55a8a0030000-55a8a0031000 r--p 00002000 08:02 40374936                   /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
55a8a0031000-55a8a0032000 r--p 00002000 08:02 40374936                   /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
55a8a0032000-55a8a0033000 rw-p 00003000 08:02 40374936                   /home/wangzc/Documents/EXPLOIT-practice/basic-cfhijack/level3
7f7a1457d000-7f7a145a2000 r--p 00000000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a145a2000-7f7a146ef000 r-xp 00025000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a146ef000-7f7a14739000 r--p 00172000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a14739000-7f7a1473a000 ---p 001bc000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a1473a000-7f7a1473d000 r--p 001bc000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a1473d000-7f7a14740000 rw-p 001bf000 08:02 21242158                   /usr/lib/libc-2.31.so
7f7a14740000-7f7a14746000 rw-p 00000000 00:00 0 
7f7a1477e000-7f7a14780000 r--p 00000000 08:02 21242144                   /usr/lib/ld-2.31.so
7f7a14780000-7f7a147a0000 r-xp 00002000 08:02 21242144                   /usr/lib/ld-2.31.so
7f7a147a0000-7f7a147a8000 r--p 00022000 08:02 21242144                   /usr/lib/ld-2.31.so
7f7a147a9000-7f7a147aa000 r--p 0002a000 08:02 21242144                   /usr/lib/ld-2.31.so
7f7a147aa000-7f7a147ab000 rw-p 0002b000 08:02 21242144                   /usr/lib/ld-2.31.so
7f7a147ab000-7f7a147ac000 rw-p 00000000 00:00 0 
7ffc5db79000-7ffc5db9a000 rw-p 00000000 00:00 0                          [stack]
7ffc5dbd8000-7ffc5dbdb000 r--p 00000000 00:00 0                          [vvar]
7ffc5dbdb000-7ffc5dbdd000 r-xp 00000000 00:00 0                          [vdso]
ffffffffff600000-ffffffffff601000 r-xp 00000000 00:00 0                  [vsyscall]